image: "debian"

before_script:
    - apt update
    - apt install -y python3


validate_challenges:
#    stage: validate_challenges
    script:
        - src/validate.py challenges/* --verbose


build_basic:
#    stage: build_basic
    script:
        - ./ctf-tool.py --address "ctf.cyberatuc.org" CTF.BASE.zip challenges/*


build_install:
#    stage: build_install
    script:
        - ./ctf-tool.py --install --address "ctf.cyberatuc.org" CTF.BASE.zip challenges/test-challenge-pack/
        - ls -lR /home/
        # TODO: assert correct permissions and that no extra files are added
        # TODO: note that v2 will use services which are easier to check

#stages:
#    - validate_challenges
#    - build_basic
#    - build_install

# TODO: v2 systemd service test
# TODO: v2 docker test
# TODO: v2 ansible package test

